<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Nasdaq Stock Price Checker</title>
	
	<link rel="icon" type="image/x-icon" href="/public/favicon.ico">
	<link rel="stylesheet" href="/public/bootstrap.min.css">
	<link rel="stylesheet" href="/public/style.css">
</head>

<body>
	<div class="container">
		<div class="p-4 my-4 bg-light rounded-3">
			<div class="row">
				<div class="col">

					<header>
						<h1 id="title" class="text-center">Nasdaq Stock Price Checker</h1>
					</header>

					<div id="userstories">
						<h3>User Stories:</h3>
						<ol>
							<li>Set the content security policies...</li>
							<li>I can <b>GET</b> <code>/api/stock-prices</code>...</li>
							<li>In <i>stockData</i>, I can see the <i>stock</i>, <i>price</i>, and <i>likes</i>.</li>
							<li>I can pass <i>like=true</i>...</li>
							<li>If I pass 2 stocks...</li>
							<li>A good way to receive price...</li>
							<li>All tests are passing.</li>
						</ol>

						<h3>Example usage:</h3>
						<ul>
							<li><a href="/api/stock-prices?stock=goog" target="_blank">/api/stock-prices?stock=goog</a></li>
							<li><a href="/api/stock-prices?stock=goog&like=true" target="_blank">/api/stock-prices?stock=goog&amp;like=true</a></li>
							<li><a href="/api/stock-prices?stock=msft" target="_blank">/api/stock-prices?stock=msft</a></li>
							<li><a href="/api/stock-prices?stock=msft&like=true" target="_blank">/api/stock-prices?stock=msft&amp;like=true</a></li>
							<li><a href="/api/stock-prices?stock=goog&stock=msft" target="_blank">/api/stock-prices?stock=goog&amp;stock=msft</a></li>
							<li><a href="/api/stock-prices?stock=goog&stock=msft&like=true" target="_blank">/api/stock-prices?stock=goog&amp;stock=msft&amp;like=true</a></li>
						</ul>

						<h3>Example return:</h3>
						<code>{"stockData":{"stock":"GOOG","price":0,"likes":0}}</code><br>
						<code>{"stockData":[{"stock":"GOOG","price":0,"rel_likes":0},{"stock":"MSFT","price":0,"rel_likes":0}]}</code>
					</div>

					<hr>

					<div id="testui">
						<h2>Front-End:</h2>

						<div class="row">

							<div class="col">
								<h3>Get single price and likes</h3>
								<form class="testForm d-flex align-items-center">
									<input type="text" class="form-control me-2" name="stock" placeholder="goog" required>
									<div class="form-check me-2">
										<input type="checkbox" name="like" class="form-check-input" value="true">
										<label class="form-check-label">Like</label>
									</div>
									<button class="btn btn-primary">Get Price</button>
								</form>
							</div>

							<div class="col">
								<h3>Compare stocks</h3>
								<form class="testForm d-flex align-items-center">
									<input type="text" class="form-control me-2" name="stock" placeholder="goog" required>
									<input type="text" class="form-control me-2" name="stock" placeholder="msft" required>
									<div class="form-check me-2">
										<input type="checkbox" name="like" class="form-check-input" value="true">
										<label class="form-check-label">Like both</label>
									</div>
									<button class="btn btn-primary">Get Price</button>
								</form>
							</div>

						</div>

						<p class="mt-2">
							<pre><code id="jsonResult"></code></pre>
						</p>

					</div>

					<hr>

					<div class="footer text-center">
						Data © Alpha Vantage — Project by freeCodeCamp
					</div>

				</div>
			</div>
		</div>
	</div>

	<script>
	document.addEventListener('DOMContentLoaded', () => {
		document.querySelectorAll('.testForm').forEach(form => {
			form.addEventListener('submit', async (e) => {
				e.preventDefault();

				try {
					const params = new URLSearchParams(new FormData(form));
					const res = await fetch('/api/stock-prices?' + params.toString());
					const json = await res.json();

					document.querySelector('#jsonResult').textContent =
						JSON.stringify(json, null, 2);

				} catch (err) {
					console.error(err);
				}
			});
		});
	});
	</script>

</body>
</html>
